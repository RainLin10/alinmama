<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>管理员页面</title>
    <script type="application/javascript" th:src="@{/webjars/jquery/jquery.js}"></script>
    <script type="application/javascript" th:src="@{/webjars/bootstrap/js/bootstrap.js}"></script>
    <script type="application/javascript" th:src="@{/webjars/bootstrap/js/bootstrap.bundle.js}"></script>
    <link rel="stylesheet" th:href="@{/webjars/bootstrap/css/bootstrap.css}">
</head>
<body>
<span th:include="public/head :: head"></span>
<div class="container-fluid"
     style="border-radius:10px;box-shadow:0px 0px 16px 5px #ccc;width: 85%;margin-top: 50px;padding-bottom: 10px;">

    <ul class="nav">
        <li class="nav-item">
            <a class="nav-link" href="../admin/findAllUsers?pn=1&where=all">所有用户</a>
        </li>
        <li class="nav-item">
            <a class="nav-link" href="../admin/findAllUsers?pn=1&where=business">所有商家</a>
        </li>
        <li class="nav-item">
            <a class="nav-link" href="../admin/findAllUsers?pn=1&where=admin">所有管理员</a>
        </li>
        <li class="nav-item">
            <a class="nav-link" href="../admin/findAllUsers?pn=1&where=service">所有客服</a>
        </li>
    </ul>
    <div class="row">
        <div class="card col-2 text-center" th:each="user:${users.list}">
            <div class="card-body">
                <img class="card-img-top " alt="Card image" th:src="${user.avatar}" style="width: 100%;height: 100px;">
                <p class="card-title" th:text="${user.nick_name}"></p>
                <p class="card-text" th:text="${user.account}"></p>
                <button class="btn btn-sm btn-primary" data-toggle="modal" th:data-target="'#modal'+${user.user_id}">
                    查看
                </button>
            </div>
            <!-- 个人信息模态框（Modal） -->
            <div class="modal fade text-left" th:id="'modal'+${user.user_id}" tabindex="-1" role="dialog"
                 aria-labelledby="myModalLabel">
                <div class="modal-dialog">
                    <div class="modal-content">
                        <form action="/admin/updateUserInfo" method="POST">
                            <div class="modal-header">
                                <h4 class="modal-title" id="myModalLabel" th:text="'用户id:'+${user.user_id}"></h4>
                            </div>

                            <div class="modal-body">

                                <div class="form-group">
                                    <input type="text" name="user_id" style="display: none" th:value="${user.user_id}"/>

                                    <label>账户:</label>
                                    <input type="text" class="form-control" name="account" th:value="${user.account}"
                                           readonly="readonly">
                                </div>
                                <div class="form-group">
                                    <label>昵称:</label>
                                    <input type="text" class="form-control" name="nick_name"
                                           th:value="${user.nick_name}" maxlength="6" required="required">
                                </div>
                                <div class="form-group">
                                    <label>性别:</label>
                                    <select class="form-control" name="gender">
                                        <option value="女" th:selected="${user.gender}=='女'?'true':'false'">女</option>
                                        <option value="男" th:selected="${user.gender}=='男'?'true':'false'">男</option>
                                    </select>
                                </div>
                                <div class="form-group">
                                    <label>角色:</label>
                                    <select class="form-control" name="role"
                                            th:disabled="${user.role}=='admin'?'true':'false'">
                                        <option value="user" th:selected="${user.role}=='user'?'true':'false'">用户
                                        </option>
                                        <option value="admin" th:selected="${user.role}=='admin'?'true':'false'">管理员
                                        </option>
                                        <option value="service" th:selected="${user.role}=='service'?'true':'false'">
                                            客服
                                        </option>
                                        <option value="seller" th:selected="${user.role}=='seller'?'true':'false'">卖家
                                        </option>
                                    </select>
                                </div>
                                <div class="form-group">
                                    <label>上次登录:</label>
                                    <input type="text" class="form-control" name="login_time" readonly="readonly"
                                           th:value="${#dates.format(user.login_time, 'yyyy-MM-dd HH:mm')}">
                                </div>
                                <div class="form-group">
                                    <label>登录ip:</label>
                                    <input type="text" class="form-control" name="login_ip" readonly="readonly"
                                           th:value="${user.login_ip}">
                                </div>
                                <div class="form-group">
                                    <label>登录次数:</label>
                                    <input type="text" class="form-control" name="login_times" readonly="readonly"
                                           th:value="${user.login_times}">
                                </div>
                                <div class="form-group">
                                    <label>注册时间:</label>
                                    <input type="text" class="form-control" name="register_time" readonly="readonly"
                                           th:value="${#dates.format(user.register_time, 'yyyy-MM-dd HH:mm')}">
                                </div>
                            </div>

                            <div class="modal-footer">
                                <button type="submit" class="btn btn-primary">修改</button>
                            </div>
                        </form>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- 显示分页信息 -->
    <div class="row">
        <!-- 分页文字信息 -->
        <div class="col-md-6">
            当前第<span style="color: cornflowerblue">[[${users.pageNum}]]</span>页,
            总<span style="color: cornflowerblue">[[${users.pages}]]</span>页,
            总共有<span style="color: cornflowerblue">[[${users.total}]]</span>条记录
        </div>
        <!-- 分页条信息 -->
        <div class="col-md-6">
            <nav aria-label="Page navigation">
                <ul class="pagination">
                    <!--首页-->
                    <li><a th:href="'/admin/findAllUsers?pn=1&where='+${where}">首页</a></li>


                    <!--页码-->
                    <div th:each="currentPageNum:${users.navigatepageNums }">
                        <div th:if="${currentPageNum==users.pageNum}" style="margin-left: 10px;">
                            <li><a href="#">[[${currentPageNum}]]</a></li>
                        </div>
                        <div th:if="${currentPageNum != users.pageNum}" style="margin-left: 10px;">
                            <li><a th:href="'/admin/findAllUsers?pn='+${currentPageNum}+'&where='+${where}">[[${currentPageNum}]]</a>
                            </li>
                        </div>
                    </div>


                    <li><a th:href="'/admin/findAllUsers?pn='+${users.pages}+'&where='+${where}" style="margin-left: 10px;">末页</a></li>
                </ul>
            </nav>
        </div>
    </div>
</div>
</body>
</html>